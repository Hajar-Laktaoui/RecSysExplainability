Epoch: 001, Loss: 631.4982
Epoch: 002, Loss: 266.2111
Epoch: 003, Loss: 104.9377
Epoch: 004, Loss: 32.4186
Epoch: 005, Loss: 37.2245
Epoch: 006, Loss: 36.6168
Epoch: 007, Loss: 28.8065
Epoch: 008, Loss: 43.4440
Epoch: 009, Loss: 43.0720
Epoch: 010, Loss: 30.0490
User Embeddings shape: torch.Size([7506, 768])
Item Embeddings shape: torch.Size([7360, 768])
----------------------------------------ARGUMENTS----------------------------------------
data_path                                ../MoviesAndTV/reviews.pickle
index_dir                                ../MoviesAndTV/1/
lr                                       0.001
epochs                                   100
batch_size                               100
cuda                                     True
log_interval                             200
checkpoint                               ./moviesAn
outf                                     generated.txt
endure_times                             5
words                                    20
----------------------------------------ARGUMENTS----------------------------------------
[2024-05-27 12:00:44.986105]: Loading data
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
7506
7360
/home/hajar.laktaoui/.local/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
[2024-05-27 12:02:51.188590]: Tuning Prompt Only
[2024-05-27 12:02:51.188673]: epoch 1
[2024-05-27 12:03:29.170452]: text ppl 78405366871.4858 |   200/ 3535 batches
[2024-05-27 12:04:06.051692]: text ppl 1244.7406 |   400/ 3535 batches
[2024-05-27 12:04:42.931876]: text ppl 554.0226 |   600/ 3535 batches
[2024-05-27 12:05:19.840950]: text ppl 409.3874 |   800/ 3535 batches
[2024-05-27 12:05:56.778782]: text ppl 339.3497 |  1000/ 3535 batches
[2024-05-27 12:06:33.745854]: text ppl 313.6130 |  1200/ 3535 batches
[2024-05-27 12:07:10.720188]: text ppl 266.5074 |  1400/ 3535 batches
[2024-05-27 12:07:47.707877]: text ppl 229.9414 |  1600/ 3535 batches
[2024-05-27 12:08:24.686157]: text ppl 206.9484 |  1800/ 3535 batches
[2024-05-27 12:09:01.654966]: text ppl 176.8102 |  2000/ 3535 batches
[2024-05-27 12:09:38.629073]: text ppl 157.1754 |  2200/ 3535 batches
[2024-05-27 12:10:15.608517]: text ppl 128.4521 |  2400/ 3535 batches
[2024-05-27 12:10:52.605245]: text ppl 106.0481 |  2600/ 3535 batches
[2024-05-27 12:11:29.560853]: text ppl 88.2146 |  2800/ 3535 batches
[2024-05-27 12:12:06.541052]: text ppl 72.7899 |  3000/ 3535 batches
[2024-05-27 12:12:43.554066]: text ppl 63.6820 |  3200/ 3535 batches
[2024-05-27 12:13:20.537833]: text ppl 54.9303 |  3400/ 3535 batches
[2024-05-27 12:13:45.378262]: text ppl 52.5184 |  3535/ 3535 batches
[2024-05-27 12:14:18.889023]: text ppl 47.1590 | valid loss 3.8535 on validation
[2024-05-27 12:14:25.529496]: epoch 2
[2024-05-27 12:15:02.634497]: text ppl 51.9292 |   200/ 3535 batches
[2024-05-27 12:15:39.614370]: text ppl 48.3553 |   400/ 3535 batches
[2024-05-27 12:16:16.614848]: text ppl 46.6305 |   600/ 3535 batches
[2024-05-27 12:16:53.566665]: text ppl 45.5109 |   800/ 3535 batches
[2024-05-27 12:17:30.530902]: text ppl 44.5094 |  1000/ 3535 batches
[2024-05-27 12:18:07.498635]: text ppl 43.2977 |  1200/ 3535 batches
[2024-05-27 12:18:44.444377]: text ppl 42.3934 |  1400/ 3535 batches
[2024-05-27 12:19:21.439362]: text ppl 41.8686 |  1600/ 3535 batches
[2024-05-27 12:19:58.404050]: text ppl 40.8363 |  1800/ 3535 batches
[2024-05-27 12:20:35.367330]: text ppl 40.4474 |  2000/ 3535 batches
[2024-05-27 12:21:12.319872]: text ppl 40.2638 |  2200/ 3535 batches
[2024-05-27 12:21:49.287369]: text ppl 39.3835 |  2400/ 3535 batches
[2024-05-27 12:22:26.234222]: text ppl 38.4209 |  2600/ 3535 batches
[2024-05-27 12:23:03.204749]: text ppl 38.6495 |  2800/ 3535 batches
[2024-05-27 12:23:40.131946]: text ppl 38.4114 |  3000/ 3535 batches
[2024-05-27 12:24:17.136316]: text ppl 37.9005 |  3200/ 3535 batches
[2024-05-27 12:24:54.093073]: text ppl 37.1439 |  3400/ 3535 batches
[2024-05-27 12:25:18.906241]: text ppl 37.7921 |  3535/ 3535 batches
[2024-05-27 12:25:52.372939]: text ppl 33.9141 | valid loss 3.5238 on validation
[2024-05-27 12:25:58.335493]: epoch 3
[2024-05-27 12:26:35.420165]: text ppl 32.8932 |   200/ 3535 batches
[2024-05-27 12:27:12.374098]: text ppl 33.1198 |   400/ 3535 batches
[2024-05-27 12:27:49.329097]: text ppl 32.9777 |   600/ 3535 batches
[2024-05-27 12:28:26.267375]: text ppl 33.0430 |   800/ 3535 batches
[2024-05-27 12:29:03.222925]: text ppl 33.4862 |  1000/ 3535 batches
[2024-05-27 12:29:40.229678]: text ppl 33.4391 |  1200/ 3535 batches
[2024-05-27 12:30:17.229144]: text ppl 33.3083 |  1400/ 3535 batches
[2024-05-27 12:30:54.237736]: text ppl 33.3795 |  1600/ 3535 batches
[2024-05-27 12:31:31.240532]: text ppl 33.4211 |  1800/ 3535 batches
[2024-05-27 12:32:08.227772]: text ppl 33.3787 |  2000/ 3535 batches
[2024-05-27 12:32:45.226619]: text ppl 33.0160 |  2200/ 3535 batches
[2024-05-27 12:33:22.186427]: text ppl 33.5015 |  2400/ 3535 batches
[2024-05-27 12:33:59.156927]: text ppl 33.4996 |  2600/ 3535 batches
[2024-05-27 12:34:36.137863]: text ppl 33.8822 |  2800/ 3535 batches
[2024-05-27 12:35:13.096841]: text ppl 33.3682 |  3000/ 3535 batches
[2024-05-27 12:35:50.044674]: text ppl 33.1364 |  3200/ 3535 batches
[2024-05-27 12:36:26.998709]: text ppl 32.6957 |  3400/ 3535 batches
[2024-05-27 12:36:51.835647]: text ppl 33.1252 |  3535/ 3535 batches
[2024-05-27 12:37:25.301420]: text ppl 32.2122 | valid loss 3.4723 on validation
[2024-05-27 12:37:31.369453]: epoch 4
[2024-05-27 12:38:08.427419]: text ppl 28.4622 |   200/ 3535 batches
[2024-05-27 12:38:45.400172]: text ppl 28.5527 |   400/ 3535 batches
[2024-05-27 12:39:22.378836]: text ppl 28.8352 |   600/ 3535 batches
[2024-05-27 12:39:59.349305]: text ppl 28.9561 |   800/ 3535 batches
[2024-05-27 12:40:36.309184]: text ppl 29.4139 |  1000/ 3535 batches
[2024-05-27 12:41:13.251864]: text ppl 29.2581 |  1200/ 3535 batches
[2024-05-27 12:41:50.222270]: text ppl 29.6558 |  1400/ 3535 batches
[2024-05-27 12:42:27.229435]: text ppl 29.6832 |  1600/ 3535 batches
[2024-05-27 12:43:04.207227]: text ppl 29.3974 |  1800/ 3535 batches
[2024-05-27 12:43:41.229378]: text ppl 29.9233 |  2000/ 3535 batches
[2024-05-27 12:44:18.232217]: text ppl 29.8067 |  2200/ 3535 batches
[2024-05-27 12:44:55.206724]: text ppl 29.7328 |  2400/ 3535 batches
[2024-05-27 12:45:32.160346]: text ppl 29.9442 |  2600/ 3535 batches
[2024-05-27 12:46:09.144646]: text ppl 29.6841 |  2800/ 3535 batches
[2024-05-27 12:46:46.107759]: text ppl 29.7036 |  3000/ 3535 batches
[2024-05-27 12:47:23.082631]: text ppl 29.8164 |  3200/ 3535 batches
[2024-05-27 12:48:00.053899]: text ppl 30.0574 |  3400/ 3535 batches
[2024-05-27 12:48:24.881722]: text ppl 30.3853 |  3535/ 3535 batches
[2024-05-27 12:48:58.378926]: text ppl 30.9125 | valid loss 3.4312 on validation
[2024-05-27 12:49:04.320320]: epoch 5
[2024-05-27 12:49:41.419589]: text ppl 25.7083 |   200/ 3535 batches
[2024-05-27 12:50:18.411414]: text ppl 26.0546 |   400/ 3535 batches
[2024-05-27 12:50:55.381931]: text ppl 26.4934 |   600/ 3535 batches
[2024-05-27 12:51:32.338869]: text ppl 26.7744 |   800/ 3535 batches
[2024-05-27 12:52:09.323356]: text ppl 26.6128 |  1000/ 3535 batches
[2024-05-27 12:52:46.319727]: text ppl 27.2572 |  1200/ 3535 batches
[2024-05-27 12:53:23.330357]: text ppl 27.3940 |  1400/ 3535 batches
[2024-05-27 12:54:00.332176]: text ppl 27.0171 |  1600/ 3535 batches
[2024-05-27 12:54:37.331941]: text ppl 27.3729 |  1800/ 3535 batches
[2024-05-27 12:55:14.319579]: text ppl 27.5730 |  2000/ 3535 batches
[2024-05-27 12:55:51.297056]: text ppl 27.7024 |  2200/ 3535 batches
[2024-05-27 12:56:28.317111]: text ppl 27.7917 |  2400/ 3535 batches
[2024-05-27 12:57:05.316127]: text ppl 27.8703 |  2600/ 3535 batches
[2024-05-27 12:57:42.289775]: text ppl 27.9452 |  2800/ 3535 batches
[2024-05-27 12:58:19.294240]: text ppl 27.7168 |  3000/ 3535 batches
[2024-05-27 12:58:56.281229]: text ppl 27.9320 |  3200/ 3535 batches
[2024-05-27 12:59:33.270851]: text ppl 27.9404 |  3400/ 3535 batches
[2024-05-27 12:59:58.120579]: text ppl 28.2151 |  3535/ 3535 batches
[2024-05-27 13:00:31.612988]: text ppl 30.5558 | valid loss 3.4196 on validation
[2024-05-27 13:00:37.563051]: epoch 6
[2024-05-27 13:01:14.701941]: text ppl 24.1578 |   200/ 3535 batches
[2024-05-27 13:01:51.732407]: text ppl 24.5031 |   400/ 3535 batches
[2024-05-27 13:02:28.757422]: text ppl 24.7586 |   600/ 3535 batches
[2024-05-27 13:03:05.785514]: text ppl 24.7276 |   800/ 3535 batches
[2024-05-27 13:03:42.817458]: text ppl 25.0793 |  1000/ 3535 batches
[2024-05-27 13:04:19.867381]: text ppl 25.7986 |  1200/ 3535 batches
[2024-05-27 13:04:56.936793]: text ppl 25.8830 |  1400/ 3535 batches
[2024-05-27 13:05:33.970540]: text ppl 25.7206 |  1600/ 3535 batches
[2024-05-27 13:06:11.039994]: text ppl 25.6958 |  1800/ 3535 batches
[2024-05-27 13:06:48.095946]: text ppl 25.8550 |  2000/ 3535 batches
[2024-05-27 13:07:25.109950]: text ppl 26.2538 |  2200/ 3535 batches
[2024-05-27 13:08:02.163968]: text ppl 26.0945 |  2400/ 3535 batches
[2024-05-27 13:08:39.218787]: text ppl 26.5445 |  2600/ 3535 batches
[2024-05-27 13:09:16.292449]: text ppl 26.3925 |  2800/ 3535 batches
[2024-05-27 13:09:53.330546]: text ppl 26.4715 |  3000/ 3535 batches
[2024-05-27 13:10:30.378710]: text ppl 26.5538 |  3200/ 3535 batches
[2024-05-27 13:11:07.442141]: text ppl 26.4340 |  3400/ 3535 batches
[2024-05-27 13:11:32.321519]: text ppl 26.6417 |  3535/ 3535 batches
[2024-05-27 13:12:05.888895]: text ppl 30.3823 | valid loss 3.4139 on validation
[2024-05-27 13:12:11.841569]: epoch 7
[2024-05-27 13:12:48.998462]: text ppl 23.0436 |   200/ 3535 batches
[2024-05-27 13:13:26.005676]: text ppl 23.0908 |   400/ 3535 batches
[2024-05-27 13:14:03.022007]: text ppl 23.6314 |   600/ 3535 batches
[2024-05-27 13:14:40.052282]: text ppl 23.9022 |   800/ 3535 batches
[2024-05-27 13:15:17.091134]: text ppl 23.8347 |  1000/ 3535 batches
[2024-05-27 13:15:54.139709]: text ppl 24.1459 |  1200/ 3535 batches
[2024-05-27 13:16:31.175207]: text ppl 24.4769 |  1400/ 3535 batches
[2024-05-27 13:17:08.194054]: text ppl 24.5034 |  1600/ 3535 batches
[2024-05-27 13:17:45.218688]: text ppl 24.6919 |  1800/ 3535 batches
[2024-05-27 13:18:22.233587]: text ppl 24.9084 |  2000/ 3535 batches
[2024-05-27 13:18:59.268046]: text ppl 25.1103 |  2200/ 3535 batches
[2024-05-27 13:19:36.318395]: text ppl 25.1671 |  2400/ 3535 batches
[2024-05-27 13:20:13.349822]: text ppl 25.0685 |  2600/ 3535 batches
[2024-05-27 13:20:50.393995]: text ppl 25.4903 |  2800/ 3535 batches
[2024-05-27 13:21:27.401081]: text ppl 25.3759 |  3000/ 3535 batches
[2024-05-27 13:22:04.431791]: text ppl 25.3767 |  3200/ 3535 batches
[2024-05-27 13:22:41.500464]: text ppl 25.3951 |  3400/ 3535 batches
[2024-05-27 13:23:06.372226]: text ppl 25.8838 |  3535/ 3535 batches
[2024-05-27 13:23:39.928201]: text ppl 30.4548 | valid loss 3.4162 on validation
[2024-05-27 13:23:39.930226]: Endured 1 time(s)
[2024-05-27 13:23:39.930252]: epoch 8
[2024-05-27 13:24:17.062864]: text ppl 21.7511 |   200/ 3535 batches
[2024-05-27 13:24:54.066850]: text ppl 22.3806 |   400/ 3535 batches
[2024-05-27 13:25:31.064065]: text ppl 22.8276 |   600/ 3535 batches
[2024-05-27 13:26:08.059621]: text ppl 23.0852 |   800/ 3535 batches
[2024-05-27 13:26:45.069919]: text ppl 22.9525 |  1000/ 3535 batches
[2024-05-27 13:27:22.054667]: text ppl 23.4194 |  1200/ 3535 batches
[2024-05-27 13:27:59.041321]: text ppl 23.5590 |  1400/ 3535 batches
[2024-05-27 13:28:36.044266]: text ppl 23.5725 |  1600/ 3535 batches
[2024-05-27 13:29:12.997049]: text ppl 23.6243 |  1800/ 3535 batches
[2024-05-27 13:29:49.978277]: text ppl 23.8232 |  2000/ 3535 batches
[2024-05-27 13:30:26.987118]: text ppl 24.0804 |  2200/ 3535 batches
[2024-05-27 13:31:03.969718]: text ppl 24.3455 |  2400/ 3535 batches
[2024-05-27 13:31:40.952300]: text ppl 24.2533 |  2600/ 3535 batches
[2024-05-27 13:32:17.934929]: text ppl 24.3966 |  2800/ 3535 batches
[2024-05-27 13:32:54.908598]: text ppl 24.5908 |  3000/ 3535 batches
[2024-05-27 13:33:31.895236]: text ppl 24.3050 |  3200/ 3535 batches
[2024-05-27 13:34:08.885838]: text ppl 24.7704 |  3400/ 3535 batches
[2024-05-27 13:34:33.722639]: text ppl 24.4893 |  3535/ 3535 batches
[2024-05-27 13:35:07.238589]: text ppl 30.8309 | valid loss 3.4285 on validation
[2024-05-27 13:35:07.240530]: Endured 2 time(s)
[2024-05-27 13:35:07.240611]: epoch 9
[2024-05-27 13:35:44.338546]: text ppl 21.1234 |   200/ 3535 batches
[2024-05-27 13:36:21.356736]: text ppl 21.5392 |   400/ 3535 batches
[2024-05-27 13:36:58.346694]: text ppl 21.9173 |   600/ 3535 batches
[2024-05-27 13:37:35.357455]: text ppl 22.4172 |   800/ 3535 batches
[2024-05-27 13:38:12.329091]: text ppl 22.4752 |  1000/ 3535 batches
[2024-05-27 13:38:49.285067]: text ppl 22.6779 |  1200/ 3535 batches
[2024-05-27 13:39:26.267260]: text ppl 22.7659 |  1400/ 3535 batches
[2024-05-27 13:40:03.250557]: text ppl 22.9090 |  1600/ 3535 batches
[2024-05-27 13:40:40.224636]: text ppl 22.9902 |  1800/ 3535 batches
[2024-05-27 13:41:17.231401]: text ppl 23.2757 |  2000/ 3535 batches
[2024-05-27 13:41:54.229743]: text ppl 23.0699 |  2200/ 3535 batches
[2024-05-27 13:42:31.228448]: text ppl 23.4872 |  2400/ 3535 batches
[2024-05-27 13:43:08.247167]: text ppl 23.2917 |  2600/ 3535 batches
[2024-05-27 13:43:45.232311]: text ppl 23.7045 |  2800/ 3535 batches
[2024-05-27 13:44:22.215349]: text ppl 23.9025 |  3000/ 3535 batches
[2024-05-27 13:44:59.207740]: text ppl 23.8164 |  3200/ 3535 batches
[2024-05-27 13:45:36.192193]: text ppl 23.8184 |  3400/ 3535 batches
[2024-05-27 13:46:01.028077]: text ppl 23.7408 |  3535/ 3535 batches
[2024-05-27 13:46:34.594020]: text ppl 30.9750 | valid loss 3.4332 on validation
[2024-05-27 13:46:34.595525]: Endured 3 time(s)
[2024-05-27 13:46:34.595611]: epoch 10
[2024-05-27 13:47:11.739283]: text ppl 20.7799 |   200/ 3535 batches
[2024-05-27 13:47:48.732024]: text ppl 21.0504 |   400/ 3535 batches
[2024-05-27 13:48:25.706765]: text ppl 21.3637 |   600/ 3535 batches
[2024-05-27 13:49:02.676082]: text ppl 21.4835 |   800/ 3535 batches
[2024-05-27 13:49:39.659177]: text ppl 21.8289 |  1000/ 3535 batches
[2024-05-27 13:50:16.651367]: text ppl 21.9659 |  1200/ 3535 batches
[2024-05-27 13:50:53.638075]: text ppl 22.0432 |  1400/ 3535 batches
[2024-05-27 13:51:30.620320]: text ppl 22.1917 |  1600/ 3535 batches
[2024-05-27 13:52:07.636668]: text ppl 22.5852 |  1800/ 3535 batches
[2024-05-27 13:52:44.642993]: text ppl 22.6035 |  2000/ 3535 batches
[2024-05-27 13:53:21.637068]: text ppl 22.7583 |  2200/ 3535 batches
[2024-05-27 13:53:58.622439]: text ppl 22.6980 |  2400/ 3535 batches
[2024-05-27 13:54:35.607920]: text ppl 22.7204 |  2600/ 3535 batches
[2024-05-27 13:55:12.605639]: text ppl 23.0025 |  2800/ 3535 batches
[2024-05-27 13:55:49.615454]: text ppl 22.9535 |  3000/ 3535 batches
[2024-05-27 13:56:26.571847]: text ppl 23.2728 |  3200/ 3535 batches
[2024-05-27 13:57:03.569646]: text ppl 23.2054 |  3400/ 3535 batches
[2024-05-27 13:57:28.402454]: text ppl 23.2499 |  3535/ 3535 batches
[2024-05-27 13:58:01.925319]: text ppl 31.2170 | valid loss 3.4410 on validation
[2024-05-27 13:58:01.925400]: Endured 4 time(s)
[2024-05-27 13:58:01.925428]: epoch 11
[2024-05-27 13:58:39.057800]: text ppl 20.3029 |   200/ 3535 batches
[2024-05-27 13:59:16.069876]: text ppl 20.5305 |   400/ 3535 batches
[2024-05-27 13:59:53.049495]: text ppl 20.6770 |   600/ 3535 batches
[2024-05-27 14:00:30.072612]: text ppl 21.0381 |   800/ 3535 batches
[2024-05-27 14:01:07.078118]: text ppl 21.1840 |  1000/ 3535 batches
[2024-05-27 14:01:44.085732]: text ppl 21.4105 |  1200/ 3535 batches
[2024-05-27 14:02:21.065419]: text ppl 21.7046 |  1400/ 3535 batches
[2024-05-27 14:02:58.028091]: text ppl 21.7391 |  1600/ 3535 batches
[2024-05-27 14:03:34.994538]: text ppl 21.8449 |  1800/ 3535 batches
[2024-05-27 14:04:11.956292]: text ppl 22.0694 |  2000/ 3535 batches
[2024-05-27 14:04:48.983191]: text ppl 22.0296 |  2200/ 3535 batches
[2024-05-27 14:05:25.965743]: text ppl 22.1099 |  2400/ 3535 batches
[2024-05-27 14:06:02.967198]: text ppl 22.4254 |  2600/ 3535 batches
[2024-05-27 14:06:39.946764]: text ppl 22.4738 |  2800/ 3535 batches
[2024-05-27 14:07:16.907859]: text ppl 22.3769 |  3000/ 3535 batches
[2024-05-27 14:07:53.901264]: text ppl 22.8184 |  3200/ 3535 batches
[2024-05-27 14:08:30.903143]: text ppl 22.8091 |  3400/ 3535 batches
[2024-05-27 14:08:55.734999]: text ppl 23.1763 |  3535/ 3535 batches
[2024-05-27 14:09:29.312477]: text ppl 31.4093 | valid loss 3.4471 on validation
[2024-05-27 14:09:29.313948]: Endured 5 time(s)
[2024-05-27 14:09:29.314015]: Cannot endure it anymore | Exiting from early stop
[2024-05-27 14:09:29.614721]: Tuning both Prompt and LM
[2024-05-27 14:09:29.655420]: epoch 1
[2024-05-27 14:10:17.821620]: text ppl 28.0457 |   200/ 3535 batches
[2024-05-27 14:11:05.838014]: text ppl 25.5803 |   400/ 3535 batches
[2024-05-27 14:11:53.880444]: text ppl 25.5127 |   600/ 3535 batches
[2024-05-27 14:12:41.908215]: text ppl 25.3578 |   800/ 3535 batches
[2024-05-27 14:13:29.957166]: text ppl 25.0657 |  1000/ 3535 batches
[2024-05-27 14:14:18.016075]: text ppl 25.1886 |  1200/ 3535 batches
[2024-05-27 14:15:06.070377]: text ppl 24.7774 |  1400/ 3535 batches
[2024-05-27 14:15:54.108670]: text ppl 24.9069 |  1600/ 3535 batches
[2024-05-27 14:16:42.123610]: text ppl 24.8765 |  1800/ 3535 batches
[2024-05-27 14:17:30.141633]: text ppl 24.4661 |  2000/ 3535 batches
[2024-05-27 14:18:18.181455]: text ppl 24.2766 |  2200/ 3535 batches
[2024-05-27 14:19:06.220017]: text ppl 24.3196 |  2400/ 3535 batches
[2024-05-27 14:19:54.245619]: text ppl 24.2780 |  2600/ 3535 batches
[2024-05-27 14:20:42.274320]: text ppl 24.4239 |  2800/ 3535 batches
[2024-05-27 14:21:30.291330]: text ppl 24.2309 |  3000/ 3535 batches
[2024-05-27 14:22:18.269530]: text ppl 23.6149 |  3200/ 3535 batches
[2024-05-27 14:23:06.309319]: text ppl 23.8001 |  3400/ 3535 batches
[2024-05-27 14:23:38.582666]: text ppl 23.7856 |  3535/ 3535 batches
[2024-05-27 14:24:12.124172]: text ppl 26.7943 | valid loss 3.2882 on validation
[2024-05-27 14:24:18.046023]: epoch 2
[2024-05-27 14:25:06.192601]: text ppl 17.8013 |   200/ 3535 batches
[2024-05-27 14:25:54.247910]: text ppl 18.3438 |   400/ 3535 batches
[2024-05-27 14:26:42.298361]: text ppl 18.8030 |   600/ 3535 batches
[2024-05-27 14:27:30.365302]: text ppl 18.9996 |   800/ 3535 batches
[2024-05-27 14:28:18.434800]: text ppl 19.0250 |  1000/ 3535 batches
[2024-05-27 14:29:06.453326]: text ppl 19.2479 |  1200/ 3535 batches
[2024-05-27 14:29:54.515846]: text ppl 19.3632 |  1400/ 3535 batches
[2024-05-27 14:30:42.576211]: text ppl 19.4248 |  1600/ 3535 batches
[2024-05-27 14:31:30.656071]: text ppl 19.5426 |  1800/ 3535 batches
[2024-05-27 14:32:18.754451]: text ppl 19.4851 |  2000/ 3535 batches
[2024-05-27 14:33:06.822273]: text ppl 19.6143 |  2200/ 3535 batches
[2024-05-27 14:33:54.893315]: text ppl 19.6924 |  2400/ 3535 batches
[2024-05-27 14:34:42.969859]: text ppl 19.7138 |  2600/ 3535 batches
[2024-05-27 14:35:31.033693]: text ppl 19.7936 |  2800/ 3535 batches
[2024-05-27 14:36:19.051442]: text ppl 19.8640 |  3000/ 3535 batches
[2024-05-27 14:37:07.065238]: text ppl 20.0589 |  3200/ 3535 batches
[2024-05-27 14:37:55.159209]: text ppl 19.9618 |  3400/ 3535 batches
[2024-05-27 14:38:27.446251]: text ppl 20.0392 |  3535/ 3535 batches
[2024-05-27 14:39:00.987764]: text ppl 25.7200 | valid loss 3.2473 on validation
[2024-05-27 14:39:06.911030]: epoch 3
[2024-05-27 14:39:55.101200]: text ppl 13.9355 |   200/ 3535 batches
[2024-05-27 14:40:43.163910]: text ppl 14.4371 |   400/ 3535 batches
[2024-05-27 14:41:31.192217]: text ppl 14.8578 |   600/ 3535 batches
[2024-05-27 14:42:19.279325]: text ppl 15.2339 |   800/ 3535 batches
[2024-05-27 14:43:07.374548]: text ppl 15.2885 |  1000/ 3535 batches
[2024-05-27 14:43:55.456319]: text ppl 15.5710 |  1200/ 3535 batches
[2024-05-27 14:44:43.541176]: text ppl 15.6209 |  1400/ 3535 batches
[2024-05-27 14:45:31.636424]: text ppl 15.9614 |  1600/ 3535 batches
[2024-05-27 14:46:19.688436]: text ppl 15.9189 |  1800/ 3535 batches
[2024-05-27 14:47:07.783697]: text ppl 16.0127 |  2000/ 3535 batches
[2024-05-27 14:47:55.847056]: text ppl 16.3148 |  2200/ 3535 batches
[2024-05-27 14:48:43.933795]: text ppl 16.2150 |  2400/ 3535 batches
[2024-05-27 14:49:32.006951]: text ppl 16.5579 |  2600/ 3535 batches
[2024-05-27 14:50:20.069268]: text ppl 16.5371 |  2800/ 3535 batches
[2024-05-27 14:51:08.161454]: text ppl 16.6775 |  3000/ 3535 batches
[2024-05-27 14:51:56.290442]: text ppl 16.7939 |  3200/ 3535 batches
[2024-05-27 14:52:44.380569]: text ppl 16.7493 |  3400/ 3535 batches
[2024-05-27 14:53:16.704407]: text ppl 16.7472 |  3535/ 3535 batches
[2024-05-27 14:53:50.259507]: text ppl 26.0383 | valid loss 3.2596 on validation
[2024-05-27 14:53:50.261193]: Endured 1 time(s)
[2024-05-27 14:53:50.261257]: epoch 4
[2024-05-27 14:54:38.482765]: text ppl 11.2461 |   200/ 3535 batches
[2024-05-27 14:55:26.575364]: text ppl 11.7715 |   400/ 3535 batches
[2024-05-27 14:56:14.628805]: text ppl 11.9798 |   600/ 3535 batches
[2024-05-27 14:57:02.726322]: text ppl 12.2935 |   800/ 3535 batches
[2024-05-27 14:57:50.778613]: text ppl 12.4881 |  1000/ 3535 batches
[2024-05-27 14:58:38.844650]: text ppl 12.8044 |  1200/ 3535 batches
[2024-05-27 14:59:26.865394]: text ppl 13.0025 |  1400/ 3535 batches
[2024-05-27 15:00:14.953838]: text ppl 13.1723 |  1600/ 3535 batches
[2024-05-27 15:01:03.013848]: text ppl 13.3399 |  1800/ 3535 batches
[2024-05-27 15:01:51.027267]: text ppl 13.4914 |  2000/ 3535 batches
[2024-05-27 15:02:39.068244]: text ppl 13.6403 |  2200/ 3535 batches
[2024-05-27 15:03:27.114526]: text ppl 13.7441 |  2400/ 3535 batches
[2024-05-27 15:04:15.187633]: text ppl 13.7729 |  2600/ 3535 batches
[2024-05-27 15:05:03.237288]: text ppl 13.9322 |  2800/ 3535 batches
[2024-05-27 15:05:51.294516]: text ppl 14.0876 |  3000/ 3535 batches
[2024-05-27 15:06:39.356275]: text ppl 14.0285 |  3200/ 3535 batches
[2024-05-27 15:07:27.371255]: text ppl 14.0978 |  3400/ 3535 batches
[2024-05-27 15:07:59.663789]: text ppl 14.2333 |  3535/ 3535 batches
[2024-05-27 15:08:33.210438]: text ppl 27.4373 | valid loss 3.3119 on validation
[2024-05-27 15:08:33.212404]: Endured 2 time(s)
[2024-05-27 15:08:33.212470]: epoch 5
[2024-05-27 15:09:21.412537]: text ppl 9.2811 |   200/ 3535 batches
[2024-05-27 15:10:09.512680]: text ppl 9.6718 |   400/ 3535 batches
[2024-05-27 15:10:57.566317]: text ppl 9.9729 |   600/ 3535 batches
[2024-05-27 15:11:45.617857]: text ppl 10.2528 |   800/ 3535 batches
[2024-05-27 15:12:33.677220]: text ppl 10.5147 |  1000/ 3535 batches
[2024-05-27 15:13:21.688989]: text ppl 10.7040 |  1200/ 3535 batches
[2024-05-27 15:14:09.816869]: text ppl 10.8619 |  1400/ 3535 batches
[2024-05-27 15:14:57.840361]: text ppl 11.0861 |  1600/ 3535 batches
[2024-05-27 15:15:45.891254]: text ppl 11.2091 |  1800/ 3535 batches
[2024-05-27 15:16:33.973126]: text ppl 11.3892 |  2000/ 3535 batches
[2024-05-27 15:17:22.007594]: text ppl 11.4015 |  2200/ 3535 batches
[2024-05-27 15:18:10.092113]: text ppl 11.6155 |  2400/ 3535 batches
[2024-05-27 15:18:58.123228]: text ppl 11.6930 |  2600/ 3535 batches
[2024-05-27 15:19:46.245423]: text ppl 11.7521 |  2800/ 3535 batches
[2024-05-27 15:20:34.325134]: text ppl 11.8203 |  3000/ 3535 batches
[2024-05-27 15:21:22.435176]: text ppl 12.0814 |  3200/ 3535 batches
[2024-05-27 15:22:10.506483]: text ppl 12.1604 |  3400/ 3535 batches
[2024-05-27 15:22:42.774725]: text ppl 12.2001 |  3535/ 3535 batches
[2024-05-27 15:23:16.321788]: text ppl 29.6118 | valid loss 3.3882 on validation
[2024-05-27 15:23:16.323394]: Endured 3 time(s)
[2024-05-27 15:23:16.323424]: epoch 6
[2024-05-27 15:24:04.522275]: text ppl 7.7804 |   200/ 3535 batches
[2024-05-27 15:24:52.579189]: text ppl 8.1201 |   400/ 3535 batches
[2024-05-27 15:25:40.624834]: text ppl 8.4175 |   600/ 3535 batches
[2024-05-27 15:26:28.711746]: text ppl 8.6293 |   800/ 3535 batches
[2024-05-27 15:27:16.769422]: text ppl 8.8660 |  1000/ 3535 batches
[2024-05-27 15:28:04.789395]: text ppl 9.0468 |  1200/ 3535 batches
[2024-05-27 15:28:52.852403]: text ppl 9.2401 |  1400/ 3535 batches
[2024-05-27 15:29:40.905127]: text ppl 9.4213 |  1600/ 3535 batches
[2024-05-27 15:30:28.942595]: text ppl 9.5825 |  1800/ 3535 batches
[2024-05-27 15:31:17.005562]: text ppl 9.5896 |  2000/ 3535 batches
[2024-05-27 15:32:05.084827]: text ppl 9.8799 |  2200/ 3535 batches
[2024-05-27 15:32:53.122359]: text ppl 9.9017 |  2400/ 3535 batches
[2024-05-27 15:33:41.195500]: text ppl 10.0095 |  2600/ 3535 batches
[2024-05-27 15:34:29.246264]: text ppl 10.1877 |  2800/ 3535 batches
[2024-05-27 15:35:17.227538]: text ppl 10.2767 |  3000/ 3535 batches
[2024-05-27 15:36:05.271668]: text ppl 10.3780 |  3200/ 3535 batches
[2024-05-27 15:36:53.288101]: text ppl 10.4673 |  3400/ 3535 batches
[2024-05-27 15:37:25.474267]: text ppl 10.6085 |  3535/ 3535 batches
[2024-05-27 15:37:59.014006]: text ppl 32.1418 | valid loss 3.4702 on validation
[2024-05-27 15:37:59.015498]: Endured 4 time(s)
[2024-05-27 15:37:59.015582]: epoch 7
[2024-05-27 15:38:47.160654]: text ppl 6.6374 |   200/ 3535 batches
[2024-05-27 15:39:35.206901]: text ppl 6.9100 |   400/ 3535 batches
[2024-05-27 15:40:23.249338]: text ppl 7.2328 |   600/ 3535 batches
[2024-05-27 15:41:11.315176]: text ppl 7.4128 |   800/ 3535 batches
[2024-05-27 15:41:59.350992]: text ppl 7.6912 |  1000/ 3535 batches
[2024-05-27 15:42:47.387881]: text ppl 7.8342 |  1200/ 3535 batches
[2024-05-27 15:43:35.409165]: text ppl 7.9895 |  1400/ 3535 batches
[2024-05-27 15:44:23.474901]: text ppl 8.0910 |  1600/ 3535 batches
[2024-05-27 15:45:11.500726]: text ppl 8.2488 |  1800/ 3535 batches
[2024-05-27 15:45:59.551796]: text ppl 8.3614 |  2000/ 3535 batches
[2024-05-27 15:46:47.630304]: text ppl 8.4944 |  2200/ 3535 batches
[2024-05-27 15:47:35.697606]: text ppl 8.5971 |  2400/ 3535 batches
[2024-05-27 15:48:23.764238]: text ppl 8.7362 |  2600/ 3535 batches
[2024-05-27 15:49:11.829704]: text ppl 8.8482 |  2800/ 3535 batches
[2024-05-27 15:49:59.896051]: text ppl 8.9110 |  3000/ 3535 batches
[2024-05-27 15:50:47.991886]: text ppl 8.9908 |  3200/ 3535 batches
[2024-05-27 15:51:36.007218]: text ppl 9.1143 |  3400/ 3535 batches
[2024-05-27 15:52:08.322812]: text ppl 9.1725 |  3535/ 3535 batches
[2024-05-27 15:52:41.877580]: text ppl 35.5426 | valid loss 3.5707 on validation
[2024-05-27 15:52:41.878684]: Endured 5 time(s)
[2024-05-27 15:52:41.878747]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2024-05-27 15:53:14.815284]: text ppl 26.0829 on test | End of training
[2024-05-27 15:53:14.815350]: Generating text
[2024-05-27 16:00:13.679049]: BLEU-1 14.3849
[2024-05-27 16:00:16.088539]: BLEU-4  0.9422
[2024-05-27 16:00:25.963403]: USR  0.2364 | USN   10446
[2024-05-27 16:05:43.157880]: DIV  2.9819
[2024-05-27 16:05:44.084404]: FCR  0.2056
[2024-05-27 16:05:44.093794]: FMR  0.1237
[2024-05-27 16:05:47.872163]: rouge_1/f_score 15.1279
[2024-05-27 16:05:47.872232]: rouge_1/r_score 14.9041
[2024-05-27 16:05:47.872241]: rouge_1/p_score 18.0770
[2024-05-27 16:05:47.872249]: rouge_2/f_score  1.9012
[2024-05-27 16:05:47.872256]: rouge_2/r_score  1.9422
[2024-05-27 16:05:47.872263]: rouge_2/p_score  2.2924
[2024-05-27 16:05:47.872269]: rouge_l/f_score 11.6534
[2024-05-27 16:05:47.872276]: rouge_l/r_score 13.6847
[2024-05-27 16:05:47.872283]: rouge_l/p_score 14.9089
[2024-05-27 16:05:48.128242]: Generated text saved to (./moviesAn/generated.txt)
