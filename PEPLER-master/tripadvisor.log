----------------------------------------ARGUMENTS----------------------------------------
data_path                                ../TripAdvisor/reviews.pickle
index_dir                                ../TripAdvisor/1/
lr                                       0.001
epochs                                   100
batch_size                               128
cuda                                     True
log_interval                             200
checkpoint                               ./tripadvisor/
outf                                     generated.txt
endure_times                             5
words                                    20
----------------------------------------ARGUMENTS----------------------------------------
[2022-01-13 10:34:08.217505]: Loading data
Special tokens have been added in the vocabulary, make sure the associated word embedding are fine-tuned or trained.
[2022-01-13 10:36:46.646978]: Tuning Prompt Only
[2022-01-13 10:36:46.647434]: epoch 1
[2022-01-13 10:38:25.400488]: text ppl 3338221204460.8350 |   200/ 2001 batches
[2022-01-13 10:40:03.418240]: text ppl 211.8923 |   400/ 2001 batches
[2022-01-13 10:41:40.559917]: text ppl 87.9993 |   600/ 2001 batches
[2022-01-13 10:43:18.703364]: text ppl 61.2194 |   800/ 2001 batches
[2022-01-13 10:44:56.249698]: text ppl 49.2267 |  1000/ 2001 batches
[2022-01-13 10:46:34.751092]: text ppl 42.0094 |  1200/ 2001 batches
[2022-01-13 10:48:12.742879]: text ppl 38.6023 |  1400/ 2001 batches
[2022-01-13 10:49:50.264742]: text ppl 35.9784 |  1600/ 2001 batches
[2022-01-13 10:51:27.593488]: text ppl 33.9776 |  1800/ 2001 batches
[2022-01-13 10:53:06.860935]: text ppl 33.0023 |  2000/ 2001 batches
[2022-01-13 10:53:06.989734]: text ppl 31.8625 |  2001/ 2001 batches
[2022-01-13 10:53:59.972231]: text ppl 26.9448 | valid loss 3.2938 on validation
[2022-01-13 10:54:01.867840]: epoch 2
[2022-01-13 10:55:40.131751]: text ppl 28.7586 |   200/ 2001 batches
[2022-01-13 10:57:18.303495]: text ppl 28.2097 |   400/ 2001 batches
[2022-01-13 10:58:56.738647]: text ppl 27.7246 |   600/ 2001 batches
[2022-01-13 11:00:34.843074]: text ppl 27.6633 |   800/ 2001 batches
[2022-01-13 11:02:12.824682]: text ppl 27.2517 |  1000/ 2001 batches
[2022-01-13 11:03:50.430669]: text ppl 27.1251 |  1200/ 2001 batches
[2022-01-13 11:05:28.641132]: text ppl 26.6861 |  1400/ 2001 batches
[2022-01-13 11:07:06.602045]: text ppl 26.6193 |  1600/ 2001 batches
[2022-01-13 11:08:45.324242]: text ppl 26.3925 |  1800/ 2001 batches
[2022-01-13 11:10:22.768309]: text ppl 26.2247 |  2000/ 2001 batches
[2022-01-13 11:10:22.875998]: text ppl 25.2626 |  2001/ 2001 batches
[2022-01-13 11:11:17.466548]: text ppl 23.8208 | valid loss 3.1706 on validation
[2022-01-13 11:11:19.407717]: epoch 3
[2022-01-13 11:12:57.147223]: text ppl 23.5890 |   200/ 2001 batches
[2022-01-13 11:14:34.584431]: text ppl 23.7042 |   400/ 2001 batches
[2022-01-13 11:16:12.168624]: text ppl 23.6897 |   600/ 2001 batches
[2022-01-13 11:17:50.863489]: text ppl 23.7943 |   800/ 2001 batches
[2022-01-13 11:19:27.964111]: text ppl 23.6318 |  1000/ 2001 batches
[2022-01-13 11:21:06.106778]: text ppl 23.5757 |  1200/ 2001 batches
[2022-01-13 11:22:44.228108]: text ppl 23.5849 |  1400/ 2001 batches
[2022-01-13 11:24:21.951612]: text ppl 23.7286 |  1600/ 2001 batches
[2022-01-13 11:25:59.945041]: text ppl 23.5552 |  1800/ 2001 batches
[2022-01-13 11:27:37.610076]: text ppl 23.6601 |  2000/ 2001 batches
[2022-01-13 11:27:37.727124]: text ppl 27.0310 |  2001/ 2001 batches
[2022-01-13 11:28:31.640718]: text ppl 22.7742 | valid loss 3.1256 on validation
[2022-01-13 11:28:33.603335]: epoch 4
[2022-01-13 11:30:12.066352]: text ppl 21.0911 |   200/ 2001 batches
[2022-01-13 11:31:50.163334]: text ppl 21.3375 |   400/ 2001 batches
[2022-01-13 11:33:28.509006]: text ppl 21.5679 |   600/ 2001 batches
[2022-01-13 11:35:06.997917]: text ppl 21.6591 |   800/ 2001 batches
[2022-01-13 11:36:45.016528]: text ppl 21.7791 |  1000/ 2001 batches
[2022-01-13 11:38:22.745847]: text ppl 21.8549 |  1200/ 2001 batches
[2022-01-13 11:40:00.664273]: text ppl 21.7999 |  1400/ 2001 batches
[2022-01-13 11:41:38.498357]: text ppl 21.7770 |  1600/ 2001 batches
[2022-01-13 11:43:16.826530]: text ppl 21.8695 |  1800/ 2001 batches
[2022-01-13 11:44:54.563184]: text ppl 21.9986 |  2000/ 2001 batches
[2022-01-13 11:44:54.664729]: text ppl 25.5117 |  2001/ 2001 batches
[2022-01-13 11:45:48.248678]: text ppl 22.5545 | valid loss 3.1159 on validation
[2022-01-13 11:45:50.211935]: epoch 5
[2022-01-13 11:47:27.997788]: text ppl 19.7130 |   200/ 2001 batches
[2022-01-13 11:49:05.936466]: text ppl 19.7680 |   400/ 2001 batches
[2022-01-13 11:50:43.735189]: text ppl 20.0730 |   600/ 2001 batches
[2022-01-13 11:52:21.633837]: text ppl 20.2254 |   800/ 2001 batches
[2022-01-13 11:54:00.141087]: text ppl 20.3870 |  1000/ 2001 batches
[2022-01-13 11:55:37.776280]: text ppl 20.3368 |  1200/ 2001 batches
[2022-01-13 11:57:16.390671]: text ppl 20.5221 |  1400/ 2001 batches
[2022-01-13 11:58:54.614076]: text ppl 20.6141 |  1600/ 2001 batches
[2022-01-13 12:00:32.429582]: text ppl 20.4892 |  1800/ 2001 batches
[2022-01-13 12:02:09.808892]: text ppl 20.5498 |  2000/ 2001 batches
[2022-01-13 12:02:09.926147]: text ppl 22.7183 |  2001/ 2001 batches
[2022-01-13 12:03:03.540102]: text ppl 22.4287 | valid loss 3.1103 on validation
[2022-01-13 12:03:05.543299]: epoch 6
[2022-01-13 12:04:43.933927]: text ppl 18.3999 |   200/ 2001 batches
[2022-01-13 12:06:22.360665]: text ppl 18.7983 |   400/ 2001 batches
[2022-01-13 12:08:00.386084]: text ppl 18.8400 |   600/ 2001 batches
[2022-01-13 12:09:38.029382]: text ppl 18.9579 |   800/ 2001 batches
[2022-01-13 12:11:16.062398]: text ppl 19.2083 |  1000/ 2001 batches
[2022-01-13 12:12:53.392292]: text ppl 19.3331 |  1200/ 2001 batches
[2022-01-13 12:14:30.971679]: text ppl 19.3819 |  1400/ 2001 batches
[2022-01-13 12:16:08.899470]: text ppl 19.5802 |  1600/ 2001 batches
[2022-01-13 12:17:47.249605]: text ppl 19.5303 |  1800/ 2001 batches
[2022-01-13 12:19:25.157408]: text ppl 19.7235 |  2000/ 2001 batches
[2022-01-13 12:19:25.270180]: text ppl 14.4163 |  2001/ 2001 batches
[2022-01-13 12:20:18.911426]: text ppl 22.5060 | valid loss 3.1138 on validation
[2022-01-13 12:20:18.911868]: Endured 1 time(s)
[2022-01-13 12:20:18.911911]: epoch 7
[2022-01-13 12:21:57.378746]: text ppl 17.4276 |   200/ 2001 batches
[2022-01-13 12:23:35.498847]: text ppl 17.7172 |   400/ 2001 batches
[2022-01-13 12:25:14.446484]: text ppl 17.9853 |   600/ 2001 batches
[2022-01-13 12:26:52.293359]: text ppl 18.2561 |   800/ 2001 batches
[2022-01-13 12:28:30.010536]: text ppl 18.3296 |  1000/ 2001 batches
[2022-01-13 12:30:07.678902]: text ppl 18.3863 |  1200/ 2001 batches
[2022-01-13 12:31:46.049615]: text ppl 18.6105 |  1400/ 2001 batches
[2022-01-13 12:33:24.685259]: text ppl 18.6142 |  1600/ 2001 batches
[2022-01-13 12:35:02.833843]: text ppl 18.7337 |  1800/ 2001 batches
[2022-01-13 12:36:40.966429]: text ppl 18.8834 |  2000/ 2001 batches
[2022-01-13 12:36:41.069737]: text ppl 22.5065 |  2001/ 2001 batches
[2022-01-13 12:37:34.817761]: text ppl 22.5896 | valid loss 3.1175 on validation
[2022-01-13 12:37:34.818218]: Endured 2 time(s)
[2022-01-13 12:37:34.818254]: epoch 8
[2022-01-13 12:39:13.175839]: text ppl 16.7483 |   200/ 2001 batches
[2022-01-13 12:40:51.133691]: text ppl 16.9085 |   400/ 2001 batches
[2022-01-13 12:42:29.472295]: text ppl 17.1505 |   600/ 2001 batches
[2022-01-13 12:44:07.310325]: text ppl 17.5984 |   800/ 2001 batches
[2022-01-13 12:45:45.183710]: text ppl 17.5633 |  1000/ 2001 batches
[2022-01-13 12:47:23.382029]: text ppl 17.5753 |  1200/ 2001 batches
[2022-01-13 12:49:01.988229]: text ppl 17.7723 |  1400/ 2001 batches
[2022-01-13 12:50:40.027332]: text ppl 17.8904 |  1600/ 2001 batches
[2022-01-13 12:52:17.799711]: text ppl 18.0108 |  1800/ 2001 batches
[2022-01-13 12:53:55.747963]: text ppl 18.0482 |  2000/ 2001 batches
[2022-01-13 12:53:55.854892]: text ppl 19.0334 |  2001/ 2001 batches
[2022-01-13 12:54:49.916467]: text ppl 22.6910 | valid loss 3.1220 on validation
[2022-01-13 12:54:49.916984]: Endured 3 time(s)
[2022-01-13 12:54:49.917023]: epoch 9
[2022-01-13 12:56:28.643442]: text ppl 16.0863 |   200/ 2001 batches
[2022-01-13 12:58:06.628329]: text ppl 16.4053 |   400/ 2001 batches
[2022-01-13 12:59:45.397368]: text ppl 16.5891 |   600/ 2001 batches
[2022-01-13 13:01:23.049207]: text ppl 16.7069 |   800/ 2001 batches
[2022-01-13 13:03:01.459756]: text ppl 16.8445 |  1000/ 2001 batches
[2022-01-13 13:04:39.551311]: text ppl 16.9788 |  1200/ 2001 batches
[2022-01-13 13:06:17.708235]: text ppl 17.1240 |  1400/ 2001 batches
[2022-01-13 13:07:55.960353]: text ppl 17.2977 |  1600/ 2001 batches
[2022-01-13 13:09:34.344960]: text ppl 17.2857 |  1800/ 2001 batches
[2022-01-13 13:11:11.929747]: text ppl 17.5781 |  2000/ 2001 batches
[2022-01-13 13:11:12.079497]: text ppl 18.3063 |  2001/ 2001 batches
[2022-01-13 13:12:05.552416]: text ppl 22.9030 | valid loss 3.1313 on validation
[2022-01-13 13:12:05.552840]: Endured 4 time(s)
[2022-01-13 13:12:05.552869]: epoch 10
[2022-01-13 13:13:43.342679]: text ppl 15.5693 |   200/ 2001 batches
[2022-01-13 13:15:21.679845]: text ppl 15.7112 |   400/ 2001 batches
[2022-01-13 13:17:00.651831]: text ppl 15.9761 |   600/ 2001 batches
[2022-01-13 13:18:38.240901]: text ppl 16.0814 |   800/ 2001 batches
[2022-01-13 13:20:16.045948]: text ppl 16.3834 |  1000/ 2001 batches
[2022-01-13 13:21:54.206094]: text ppl 16.4420 |  1200/ 2001 batches
[2022-01-13 13:23:32.142128]: text ppl 16.6026 |  1400/ 2001 batches
[2022-01-13 13:25:10.260707]: text ppl 16.6983 |  1600/ 2001 batches
[2022-01-13 13:26:48.548779]: text ppl 16.8097 |  1800/ 2001 batches
[2022-01-13 13:28:26.336408]: text ppl 16.9565 |  2000/ 2001 batches
[2022-01-13 13:28:26.445620]: text ppl 16.9903 |  2001/ 2001 batches
[2022-01-13 13:29:19.994322]: text ppl 23.1919 | valid loss 3.1438 on validation
[2022-01-13 13:29:19.994730]: Endured 5 time(s)
[2022-01-13 13:29:19.994760]: Cannot endure it anymore | Exiting from early stop
[2022-01-13 13:29:21.057011]: Tuning both Prompt and LM
[2022-01-13 13:29:21.060355]: epoch 1
[2022-01-13 13:31:24.055633]: text ppl 20.7702 |   200/ 2001 batches
[2022-01-13 13:33:27.616398]: text ppl 18.3621 |   400/ 2001 batches
[2022-01-13 13:35:30.588097]: text ppl 18.0437 |   600/ 2001 batches
[2022-01-13 13:37:33.856901]: text ppl 17.8245 |   800/ 2001 batches
[2022-01-13 13:39:38.006049]: text ppl 17.7636 |  1000/ 2001 batches
[2022-01-13 13:41:40.686006]: text ppl 17.6340 |  1200/ 2001 batches
[2022-01-13 13:43:44.211974]: text ppl 17.5131 |  1400/ 2001 batches
[2022-01-13 13:45:46.931032]: text ppl 17.3117 |  1600/ 2001 batches
[2022-01-13 13:47:50.166621]: text ppl 17.4052 |  1800/ 2001 batches
[2022-01-13 13:49:53.334411]: text ppl 17.1761 |  2000/ 2001 batches
[2022-01-13 13:49:53.491476]: text ppl 17.5312 |  2001/ 2001 batches
[2022-01-13 13:50:47.085128]: text ppl 19.1993 | valid loss 2.9549 on validation
[2022-01-13 13:50:49.111555]: epoch 2
[2022-01-13 13:52:52.508357]: text ppl 13.3812 |   200/ 2001 batches
[2022-01-13 13:54:55.257950]: text ppl 13.9109 |   400/ 2001 batches
[2022-01-13 13:56:58.128635]: text ppl 14.2011 |   600/ 2001 batches
[2022-01-13 13:59:00.829278]: text ppl 14.4500 |   800/ 2001 batches
[2022-01-13 14:01:03.762123]: text ppl 14.5497 |  1000/ 2001 batches
[2022-01-13 14:03:06.524201]: text ppl 14.6023 |  1200/ 2001 batches
[2022-01-13 14:05:08.150337]: text ppl 14.6693 |  1400/ 2001 batches
[2022-01-13 14:07:10.202787]: text ppl 14.8936 |  1600/ 2001 batches
[2022-01-13 14:09:12.218335]: text ppl 14.8254 |  1800/ 2001 batches
[2022-01-13 14:11:15.888984]: text ppl 14.9077 |  2000/ 2001 batches
[2022-01-13 14:11:16.042462]: text ppl 15.9433 |  2001/ 2001 batches
[2022-01-13 14:12:09.371779]: text ppl 18.9261 | valid loss 2.9405 on validation
[2022-01-13 14:12:11.561492]: epoch 3
[2022-01-13 14:14:14.666097]: text ppl 10.8352 |   200/ 2001 batches
[2022-01-13 14:16:17.030122]: text ppl 11.4201 |   400/ 2001 batches
[2022-01-13 14:18:19.631684]: text ppl 11.6250 |   600/ 2001 batches
[2022-01-13 14:20:22.599981]: text ppl 11.9398 |   800/ 2001 batches
[2022-01-13 14:22:25.958858]: text ppl 12.1041 |  1000/ 2001 batches
[2022-01-13 14:24:28.635520]: text ppl 12.2891 |  1200/ 2001 batches
[2022-01-13 14:26:31.694851]: text ppl 12.4650 |  1400/ 2001 batches
[2022-01-13 14:28:34.830111]: text ppl 12.5573 |  1600/ 2001 batches
[2022-01-13 14:30:37.618632]: text ppl 12.6017 |  1800/ 2001 batches
[2022-01-13 14:32:41.061537]: text ppl 12.7334 |  2000/ 2001 batches
[2022-01-13 14:32:41.316860]: text ppl 10.3641 |  2001/ 2001 batches
[2022-01-13 14:33:34.672459]: text ppl 19.5007 | valid loss 2.9705 on validation
[2022-01-13 14:33:34.672908]: Endured 1 time(s)
[2022-01-13 14:33:34.672939]: epoch 4
[2022-01-13 14:35:37.746464]: text ppl 8.8355 |   200/ 2001 batches
[2022-01-13 14:37:40.323513]: text ppl 9.2442 |   400/ 2001 batches
[2022-01-13 14:39:44.304581]: text ppl 9.6612 |   600/ 2001 batches
[2022-01-13 14:41:46.634003]: text ppl 9.9732 |   800/ 2001 batches
[2022-01-13 14:43:49.804625]: text ppl 10.1085 |  1000/ 2001 batches
[2022-01-13 14:45:52.673312]: text ppl 10.2872 |  1200/ 2001 batches
[2022-01-13 14:47:56.029036]: text ppl 10.4230 |  1400/ 2001 batches
[2022-01-13 14:49:58.866278]: text ppl 10.6046 |  1600/ 2001 batches
[2022-01-13 14:52:01.421639]: text ppl 10.7219 |  1800/ 2001 batches
[2022-01-13 14:54:03.555369]: text ppl 10.9156 |  2000/ 2001 batches
[2022-01-13 14:54:03.707791]: text ppl 14.8507 |  2001/ 2001 batches
[2022-01-13 14:54:57.765692]: text ppl 20.9070 | valid loss 3.0401 on validation
[2022-01-13 14:54:57.766248]: Endured 2 time(s)
[2022-01-13 14:54:57.766293]: epoch 5
[2022-01-13 14:57:01.105416]: text ppl 7.2028 |   200/ 2001 batches
[2022-01-13 14:59:03.598917]: text ppl 7.6556 |   400/ 2001 batches
[2022-01-13 15:01:04.991622]: text ppl 8.0335 |   600/ 2001 batches
[2022-01-13 15:03:07.540562]: text ppl 8.2647 |   800/ 2001 batches
[2022-01-13 15:05:09.838438]: text ppl 8.4865 |  1000/ 2001 batches
[2022-01-13 15:07:12.307639]: text ppl 8.6582 |  1200/ 2001 batches
[2022-01-13 15:09:15.017577]: text ppl 8.7923 |  1400/ 2001 batches
[2022-01-13 15:11:17.605810]: text ppl 9.0106 |  1600/ 2001 batches
[2022-01-13 15:13:20.804053]: text ppl 9.0554 |  1800/ 2001 batches
[2022-01-13 15:15:24.333106]: text ppl 9.2137 |  2000/ 2001 batches
[2022-01-13 15:15:24.501566]: text ppl 7.8923 |  2001/ 2001 batches
[2022-01-13 15:16:18.046646]: text ppl 23.4856 | valid loss 3.1564 on validation
[2022-01-13 15:16:18.047126]: Endured 3 time(s)
[2022-01-13 15:16:18.047160]: epoch 6
[2022-01-13 15:18:21.569777]: text ppl 5.9885 |   200/ 2001 batches
[2022-01-13 15:20:24.658040]: text ppl 6.3941 |   400/ 2001 batches
[2022-01-13 15:22:27.437259]: text ppl 6.6848 |   600/ 2001 batches
[2022-01-13 15:24:30.780766]: text ppl 6.9083 |   800/ 2001 batches
[2022-01-13 15:26:34.211028]: text ppl 7.1441 |  1000/ 2001 batches
[2022-01-13 15:28:36.796789]: text ppl 7.2844 |  1200/ 2001 batches
[2022-01-13 15:30:39.827230]: text ppl 7.4540 |  1400/ 2001 batches
[2022-01-13 15:32:43.406016]: text ppl 7.6050 |  1600/ 2001 batches
[2022-01-13 15:34:46.858284]: text ppl 7.7519 |  1800/ 2001 batches
[2022-01-13 15:36:50.593452]: text ppl 7.9031 |  2000/ 2001 batches
[2022-01-13 15:36:50.773006]: text ppl 7.1496 |  2001/ 2001 batches
[2022-01-13 15:37:44.807408]: text ppl 26.0262 | valid loss 3.2591 on validation
[2022-01-13 15:37:44.807852]: Endured 4 time(s)
[2022-01-13 15:37:44.807887]: epoch 7
[2022-01-13 15:39:48.267659]: text ppl 5.0710 |   200/ 2001 batches
[2022-01-13 15:41:51.088586]: text ppl 5.3893 |   400/ 2001 batches
[2022-01-13 15:43:54.362001]: text ppl 5.6352 |   600/ 2001 batches
[2022-01-13 15:45:57.488044]: text ppl 5.8603 |   800/ 2001 batches
[2022-01-13 15:48:00.696126]: text ppl 6.1062 |  1000/ 2001 batches
[2022-01-13 15:50:03.618086]: text ppl 6.2376 |  1200/ 2001 batches
[2022-01-13 15:52:06.980963]: text ppl 6.3889 |  1400/ 2001 batches
[2022-01-13 15:54:10.608409]: text ppl 6.5150 |  1600/ 2001 batches
[2022-01-13 15:56:14.635531]: text ppl 6.6366 |  1800/ 2001 batches
[2022-01-13 15:58:17.712903]: text ppl 6.7714 |  2000/ 2001 batches
[2022-01-13 15:58:17.872869]: text ppl 5.9800 |  2001/ 2001 batches
[2022-01-13 15:59:11.631147]: text ppl 30.0511 | valid loss 3.4029 on validation
[2022-01-13 15:59:11.631625]: Endured 5 time(s)
[2022-01-13 15:59:11.631659]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2022-01-13 16:00:02.848831]: text ppl 18.9874 on test | End of training
[2022-01-13 16:00:02.848946]: Generating text
[2022-01-13 16:10:49.974697]: BLEU-1 14.9568
[2022-01-13 16:10:53.349005]: BLEU-4  1.0163
[2022-01-13 16:11:03.118849]: USR  0.2025 | USN    6480
[2022-01-13 16:14:32.446779]: DIV  2.6520
[2022-01-13 16:14:32.684413]: FCR  0.2033
[2022-01-13 16:14:32.717781]: FMR  0.0616
[2022-01-13 16:14:36.299721]: rouge_1/f_score 16.2333
[2022-01-13 16:14:36.300057]: rouge_1/r_score 15.4014
[2022-01-13 16:14:36.300085]: rouge_1/p_score 19.6865
[2022-01-13 16:14:36.300100]: rouge_2/f_score  2.0418
[2022-01-13 16:14:36.300114]: rouge_2/r_score  2.0637
[2022-01-13 16:14:36.300126]: rouge_2/p_score  2.3770
[2022-01-13 16:14:36.300139]: rouge_l/f_score 12.8282
[2022-01-13 16:14:36.300152]: rouge_l/r_score 14.2130
[2022-01-13 16:14:36.300164]: rouge_l/p_score 16.6049
[2022-01-13 16:14:36.339981]: Generated text saved to (./tripadvisor/generated.txt)
