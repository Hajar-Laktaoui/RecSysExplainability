----------------------------------------ARGUMENTS----------------------------------------
data_path                                ../TripAdvisor/reviews.pickle
index_dir                                ../TripAdvisor/1/
lr                                       0.0001
epochs                                   100
batch_size                               128
cuda                                     True
log_interval                             200
checkpoint                               ./tripadvisord/
outf                                     generated.txt
endure_times                             5
words                                    20
----------------------------------------ARGUMENTS----------------------------------------
[2022-01-11 16:21:52.528538]: Loading data
Special tokens have been added in the vocabulary, make sure the associated word embedding are fine-tuned or trained.
[2022-01-11 16:26:35.606278]: epoch 1
[2022-01-11 16:29:10.562349]: text ppl 130.6655 |   200/ 2001 batches
[2022-01-11 16:31:45.148871]: text ppl 27.8735 |   400/ 2001 batches
[2022-01-11 16:34:22.339710]: text ppl 24.6179 |   600/ 2001 batches
[2022-01-11 16:37:00.586246]: text ppl 22.4165 |   800/ 2001 batches
[2022-01-11 16:39:38.717240]: text ppl 20.9332 |  1000/ 2001 batches
[2022-01-11 16:42:17.113214]: text ppl 19.8699 |  1200/ 2001 batches
[2022-01-11 16:44:55.636875]: text ppl 19.4243 |  1400/ 2001 batches
[2022-01-11 16:47:32.922458]: text ppl 18.7619 |  1600/ 2001 batches
[2022-01-11 16:50:11.420669]: text ppl 18.3264 |  1800/ 2001 batches
[2022-01-11 16:52:50.316365]: text ppl 18.0029 |  2000/ 2001 batches
[2022-01-11 16:52:50.524815]: text ppl 22.2097 |  2001/ 2001 batches
[2022-01-11 16:54:02.266798]: text ppl 19.7838 | valid loss 2.9849 on validation
[2022-01-11 16:54:03.984935]: epoch 2
[2022-01-11 16:56:42.377927]: text ppl 16.9926 |   200/ 2001 batches
[2022-01-11 16:59:21.365142]: text ppl 16.8102 |   400/ 2001 batches
[2022-01-11 17:01:58.800482]: text ppl 16.6807 |   600/ 2001 batches
[2022-01-11 17:04:37.542898]: text ppl 16.6566 |   800/ 2001 batches
[2022-01-11 17:07:14.785012]: text ppl 16.5124 |  1000/ 2001 batches
[2022-01-11 17:09:52.971612]: text ppl 16.1175 |  1200/ 2001 batches
[2022-01-11 17:12:32.040884]: text ppl 15.9878 |  1400/ 2001 batches
[2022-01-11 17:15:10.751093]: text ppl 15.9611 |  1600/ 2001 batches
[2022-01-11 17:17:50.313335]: text ppl 15.9222 |  1800/ 2001 batches
[2022-01-11 17:20:29.435006]: text ppl 15.6735 |  2000/ 2001 batches
[2022-01-11 17:20:29.640633]: text ppl 19.0870 |  2001/ 2001 batches
[2022-01-11 17:21:40.887795]: text ppl 18.4530 | valid loss 2.9152 on validation
[2022-01-11 17:21:42.637858]: epoch 3
[2022-01-11 17:24:21.959641]: text ppl 14.6652 |   200/ 2001 batches
[2022-01-11 17:27:00.099643]: text ppl 14.5921 |   400/ 2001 batches
[2022-01-11 17:29:38.743466]: text ppl 14.5711 |   600/ 2001 batches
[2022-01-11 17:32:17.060811]: text ppl 14.5504 |   800/ 2001 batches
[2022-01-11 17:34:55.484825]: text ppl 14.5070 |  1000/ 2001 batches
[2022-01-11 17:37:33.964653]: text ppl 14.4095 |  1200/ 2001 batches
[2022-01-11 17:40:13.690587]: text ppl 14.4807 |  1400/ 2001 batches
[2022-01-11 17:42:52.121084]: text ppl 14.3962 |  1600/ 2001 batches
[2022-01-11 17:45:29.868275]: text ppl 14.3754 |  1800/ 2001 batches
[2022-01-11 17:48:08.844095]: text ppl 14.3304 |  2000/ 2001 batches
[2022-01-11 17:48:08.998816]: text ppl 15.5657 |  2001/ 2001 batches
[2022-01-11 17:49:20.405553]: text ppl 18.2419 | valid loss 2.9037 on validation
[2022-01-11 17:49:22.177413]: epoch 4
[2022-01-11 17:52:02.337061]: text ppl 13.1470 |   200/ 2001 batches
[2022-01-11 17:54:41.213194]: text ppl 13.1871 |   400/ 2001 batches
[2022-01-11 17:57:20.439818]: text ppl 13.2189 |   600/ 2001 batches
[2022-01-11 17:59:58.951127]: text ppl 13.2565 |   800/ 2001 batches
[2022-01-11 18:02:38.197472]: text ppl 13.2779 |  1000/ 2001 batches
[2022-01-11 18:05:17.436083]: text ppl 13.1795 |  1200/ 2001 batches
[2022-01-11 18:07:56.525338]: text ppl 13.2146 |  1400/ 2001 batches
[2022-01-11 18:10:34.997279]: text ppl 13.3203 |  1600/ 2001 batches
[2022-01-11 18:13:13.756561]: text ppl 13.2643 |  1800/ 2001 batches
[2022-01-11 18:15:52.243761]: text ppl 13.1352 |  2000/ 2001 batches
[2022-01-11 18:15:52.427709]: text ppl 14.8221 |  2001/ 2001 batches
[2022-01-11 18:17:04.108299]: text ppl 18.3514 | valid loss 2.9097 on validation
[2022-01-11 18:17:04.108697]: Endured 1 time(s)
[2022-01-11 18:17:04.108735]: epoch 5
[2022-01-11 18:19:43.358688]: text ppl 12.0278 |   200/ 2001 batches
[2022-01-11 18:22:21.720268]: text ppl 12.0564 |   400/ 2001 batches
[2022-01-11 18:25:01.973543]: text ppl 12.1840 |   600/ 2001 batches
[2022-01-11 18:27:40.063196]: text ppl 12.1916 |   800/ 2001 batches
[2022-01-11 18:30:19.103542]: text ppl 12.1772 |  1000/ 2001 batches
[2022-01-11 18:32:57.737576]: text ppl 12.2730 |  1200/ 2001 batches
[2022-01-11 18:35:35.854478]: text ppl 12.2984 |  1400/ 2001 batches
[2022-01-11 18:38:14.876548]: text ppl 12.2335 |  1600/ 2001 batches
[2022-01-11 18:40:54.250678]: text ppl 12.2684 |  1800/ 2001 batches
[2022-01-11 18:43:33.371745]: text ppl 12.2617 |  2000/ 2001 batches
[2022-01-11 18:43:33.544945]: text ppl 11.0158 |  2001/ 2001 batches
[2022-01-11 18:44:45.433468]: text ppl 18.6038 | valid loss 2.9234 on validation
[2022-01-11 18:44:45.433911]: Endured 2 time(s)
[2022-01-11 18:44:45.433950]: epoch 6
[2022-01-11 18:47:24.937732]: text ppl 11.0017 |   200/ 2001 batches
[2022-01-11 18:50:03.439651]: text ppl 11.2768 |   400/ 2001 batches
[2022-01-11 18:52:42.299618]: text ppl 11.2249 |   600/ 2001 batches
[2022-01-11 18:55:20.509189]: text ppl 11.3052 |   800/ 2001 batches
[2022-01-11 18:57:58.811961]: text ppl 11.3774 |  1000/ 2001 batches
[2022-01-11 19:00:37.381156]: text ppl 11.2727 |  1200/ 2001 batches
[2022-01-11 19:03:16.004742]: text ppl 11.4301 |  1400/ 2001 batches
[2022-01-11 19:05:54.102786]: text ppl 11.3331 |  1600/ 2001 batches
[2022-01-11 19:08:33.479152]: text ppl 11.5245 |  1800/ 2001 batches
[2022-01-11 19:11:12.681229]: text ppl 11.4947 |  2000/ 2001 batches
[2022-01-11 19:11:12.840051]: text ppl 7.7522 |  2001/ 2001 batches
[2022-01-11 19:12:23.832331]: text ppl 19.3438 | valid loss 2.9624 on validation
[2022-01-11 19:12:23.832756]: Endured 3 time(s)
[2022-01-11 19:12:23.832792]: epoch 7
[2022-01-11 19:15:03.135094]: text ppl 10.2180 |   200/ 2001 batches
[2022-01-11 19:17:42.219126]: text ppl 10.4222 |   400/ 2001 batches
[2022-01-11 19:20:21.052885]: text ppl 10.4092 |   600/ 2001 batches
[2022-01-11 19:23:00.725190]: text ppl 10.4604 |   800/ 2001 batches
[2022-01-11 19:25:39.976674]: text ppl 10.6236 |  1000/ 2001 batches
[2022-01-11 19:28:18.694959]: text ppl 10.5844 |  1200/ 2001 batches
[2022-01-11 19:30:57.597208]: text ppl 10.6528 |  1400/ 2001 batches
[2022-01-11 19:33:37.174551]: text ppl 10.6967 |  1600/ 2001 batches
[2022-01-11 19:36:15.660069]: text ppl 10.6818 |  1800/ 2001 batches
[2022-01-11 19:38:54.094614]: text ppl 10.7964 |  2000/ 2001 batches
[2022-01-11 19:38:54.248897]: text ppl 12.1242 |  2001/ 2001 batches
[2022-01-11 19:40:06.239260]: text ppl 19.5561 | valid loss 2.9733 on validation
[2022-01-11 19:40:06.239730]: Endured 4 time(s)
[2022-01-11 19:40:06.239766]: epoch 8
[2022-01-11 19:42:45.558857]: text ppl 9.4676 |   200/ 2001 batches
[2022-01-11 19:45:24.151930]: text ppl 9.6909 |   400/ 2001 batches
[2022-01-11 19:48:03.144877]: text ppl 9.6939 |   600/ 2001 batches
[2022-01-11 19:50:41.792725]: text ppl 9.7698 |   800/ 2001 batches
[2022-01-11 19:53:20.701037]: text ppl 9.9222 |  1000/ 2001 batches
[2022-01-11 19:55:59.624935]: text ppl 9.9609 |  1200/ 2001 batches
[2022-01-11 19:58:38.198070]: text ppl 9.9225 |  1400/ 2001 batches
[2022-01-11 20:01:16.764025]: text ppl 10.0605 |  1600/ 2001 batches
[2022-01-11 20:03:56.003839]: text ppl 10.0412 |  1800/ 2001 batches
[2022-01-11 20:06:33.885831]: text ppl 10.0852 |  2000/ 2001 batches
[2022-01-11 20:06:34.050608]: text ppl 13.1846 |  2001/ 2001 batches
[2022-01-11 20:07:45.646685]: text ppl 20.7502 | valid loss 3.0326 on validation
[2022-01-11 20:07:45.647091]: Endured 5 time(s)
[2022-01-11 20:07:45.647136]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2022-01-11 20:08:53.471821]: text ppl 18.2564 on test | End of training
[2022-01-11 20:08:53.471943]: Generating text
[2022-01-11 20:23:33.133354]: BLEU-1 13.9672
[2022-01-11 20:23:36.332103]: BLEU-4  0.7814
[2022-01-11 20:23:37.942486]: USR  0.0601 | USN    1922
[2022-01-11 20:26:47.830741]: DIV  2.4252
[2022-01-11 20:26:48.039196]: FCR  0.1934
[2022-01-11 20:26:48.074084]: FMR  0.0495
[2022-01-11 20:26:53.496670]: rouge_1/f_score 15.0937
[2022-01-11 20:26:53.496980]: rouge_1/r_score 14.3078
[2022-01-11 20:26:53.497007]: rouge_1/p_score 18.2270
[2022-01-11 20:26:53.497021]: rouge_2/f_score  1.4526
[2022-01-11 20:26:53.497035]: rouge_2/r_score  1.4936
[2022-01-11 20:26:53.497048]: rouge_2/p_score  1.6581
[2022-01-11 20:26:53.497061]: rouge_l/f_score 11.8613
[2022-01-11 20:26:53.497074]: rouge_l/r_score 13.0541
[2022-01-11 20:26:53.497086]: rouge_l/p_score 15.9313
[2022-01-11 20:26:53.547848]: Generated text saved to (./tripadvisord/generated.txt)
